<%- include('../partials/header.ejs', { pageTitle: 'Feed Him' }) %>

    <link rel="stylesheet" href="/css/home.css">
    <div class="pet-container">
        <div class="pet-image" id="pet-image"></div>
        <img class="pet-img" id="pet-img" src="/public/img/pets/jimmy.png" alt="Jimmy the pet">
        <form class="feed-form" id="feed-form" action="/pet/games" method="POST">
            <input type="hidden" name="timesFed" id="timesFed" value="0">
            <button class="feed-button" id="feeder" type="submit">Click to feed</button>
        </form>
    </div>

    <div id="text" class="feed-text">

    </div>
    <div id="foodCounter" class="food-counter"></div>

    <script>

        /*
        Hayden I know this is spagetti code I just wanted to get this done for the MVP
        */

        let hungerLevel = 100;
        const hungerDecreaseRate = 5;
        let happinessLevel = 50;
        const happinessIncreaseRate = 12;
        const happinessDecreaseRate = 10;

        function decreaseHunger() {
            if (hungerLevel > 0) {
                hungerLevel -= hungerDecreaseRate;
                if (hungerLevel <= 0) { 
                    hungerLevel = 0;
                    window.location.replace('/end');
                }
                document.getElementById('hungerLevel').textContent = `Hunger Level: ${hungerLevel}`;
            }
        }

        function decreaseHappiness() {
            if (happinessLevel > 0) {
                happinessLevel -= happinessDecreaseRate;
                if (happinessLevel < 0) {
                    happinessLevel = 0;
                }
                document.getElementById('happinessLevel').textContent = `Happiness Level: ${happinessLevel}`;
            }
        }

        setInterval(decreaseHunger, 1000);
        setInterval(decreaseHappiness, 2000);

        const hungerDisplay = document.createElement('div');
        hungerDisplay.id = 'hungerLevel';
        hungerDisplay.textContent = `Hunger Level: ${hungerLevel}`;
        document.body.appendChild(hungerDisplay);

        const happinessDisplay = document.createElement('div');
        happinessDisplay.id = 'happinessLevel';
        happinessDisplay.textContent = `Happiness Level: ${happinessLevel}`;
        document.body.appendChild(happinessDisplay);

        document.getElementById('feeder').addEventListener('click', () => {
            let text = document.getElementById('text');
            let foodCounterElement = document.getElementById('foodCounter');
            let foodCounter = parseInt(foodCounterElement.textContent);

            console.log('feed');

            if (hungerLevel < 100) {
                hungerLevel = hungerLevel + 5;
                document.getElementById('hungerLevel').textContent = `Hunger Level: ${hungerLevel}`;

                happinessLevel = Math.min(happinessLevel + happinessIncreaseRate, 100);
                document.getElementById('happinessLevel').textContent = `Happiness Level: ${happinessLevel}`;

                foodCounter++;
                foodCounterElement.textContent = foodCounter;

                document.getElementById('timesFed').value = foodCounter;

                const phrases = ['Yum!', 'Delicious!', 'More please!', 'Tasty!', 'So good!', 'Yummy!', 'Nom nom nom!', 'GOOD FEET!', 'I LIKE THE WAY YOU SMELL!', 'I LOVE YOU!', 'YOUR SOUL IS MINE!'];
                const randomPhrase = phrases[Math.floor(Math.random() * phrases.length)];
                text.innerHTML = `<center><b>${randomPhrase}</b><center>`;

            } else {
                text.innerHTML = '<center><b>Too full!</b><center>';
            }
        });
    </script>

    <%- include('../partials/footer.ejs') %>